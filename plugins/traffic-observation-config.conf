# ------------------------------------------------------------------------
# OWASP CRS Plugin
# Copyright (c) 2021-2025 CRS project. All rights reserved.
#
# The OWASP CRS plugins are distributed under
# Apache Software License (ASL) version 2
# Please see the enclosed LICENSE file for full details.
# ------------------------------------------------------------------------

# OWASP CRS Plugin
# Plugin name: traffic-observation-plugin
# Plugin description: This is an offical CRS plugin that logs information 
#                     about requests that is not normally logged.
# Rule ID block base: 9,526,000 (range is 1000, thus ID block base +1000)
# Plugin version: 1.0.0

# Generic rule to disable the plugin
#
# Plugins are enabled by default.
#
# They become active by placing them in the plugin folder. It is possible to
# control plugin activation via setting a variable. This can be done in the
# plugin config file here.
#
# The predefined variable name is meant to be "<plugin name>-plugin_enabled".
# For the template-plugin, this means it can be disabled by setting
# tx.template-plugin_enabled=0.
#
# Note that a global setting of this variable overrides the setting here.
# That means the "enabled" variable is only set by this rule if it has not
# been set before.
#
# Feel free to set the variable unconditionally here by replacing the
# SecRule line with an unconditional SecAction statement.
#
#SecRule &TX:traffic-observation-plugin_enabled "@eq 0" \
#  "id:9500010,\
#   phase:1,\
#   pass,\
#   nolog,\
#   setvar:'tx.traffic-observation-plugin_enabled=0'"


# Sampling Mode
#
# There are services where a log message for every request is far too much.
#
# The sampling mode of this plugin allows you to log only on a small percentage
# of requests.
#
# The variable supports numbers from 0.0 to 100. So a single digit after the
# dot is supported.
#
# If you want to log a single request in 1,000 requests, write this as
# tx.traffic-observation-sampling_percentage=0.1
#
#SecRule &TX:traffic-observation-sampling_percentage "@eq 0" \
#  "id:9500020,\
#   phase:1,\
#   pass,\
#   nolog,\
#   setvar:'tx.traffic-observation-sampling_percentage=1.0'"
